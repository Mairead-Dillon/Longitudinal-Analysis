---
title: "GCSF Analysis"
author: "Mairead Dillon"
date: '2023-01-24'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(lme4)

# Import data
gcsf_wide <- read_xlsx("/Users/maireaddillon/Documents/Duke/BIOS-718/Longitudinal-Analysis/HW2/gcsf.xlsx")

gcsf_long <- read_xlsx("/Users/maireaddillon/Documents/Duke/BIOS-718/Longitudinal-Analysis/HW2/gcsf.xlsx", sheet=2)
```
     
```{r}
# Reformat data
gcsf_long$id <- as.factor(gcsf_long$id)
gcsf_long$age <- as.factor(gcsf_long$age)
gcsf_long$gcsf <- as.factor(gcsf_long$gcsf)
```
     
     
```{r}
# Create mixed effects model
mod1 <- lmer(cfu ~ age + gcsf + days + (1|id), data=gcsf_long)
summary(mod1)

mod2 <- lmer(cfu ~ age + gcsf + age:gcsf + (days|id), data=gcsf_long)
```
     
```{r}
# Make spaghetti plot
ggplot(data=gcsf_long, aes(x=days, y=cfu, group=id, color=age)) +
  geom_point() + geom_line() +
  xlab("Days") +
  ylab("Colony Forming Units") +
  ggtitle("Change in Colony Forming Units Over Time Per Person") +
  labs(color = "Age") +
  theme(plot.title = element_text(hjust=0.5)) +
  theme_bw()
```

     